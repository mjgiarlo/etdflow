<h2><%= @view.title %></h2>

<%= render partial: 'shared/error_messages', locals: { object: @submission } %>

<%= simple_form_for @submission, url: @view.form_for_url, html: { class: "admin-edit-submission #{@submission.status_class}" } do |f| %>

  <div class="form-section-body">
    <%= f.input :title %>
  </div>

  <div class="form-section-heading" data-toggle="collapse" data-target="#author-information">Author Information
    <span class="hide-show-indicator fa-rotate-90"></span>
  </div>
  <div id="author-information" class="form-section-body collapse in">
    <div class="row">
      <div class="col-xs-12 col-sm-6">
        <p>
          <%= @submission.author.full_name %><br />
          <%= @submission.author.address_1 %><br />
          <% if @submission.author.address_2.present? %>
            <%= @submission.author.address_2 %><br />
          <% end %>
          <%= @submission.author.city %>, <%= @submission.author.state %> <%= @submission.author.zip %><br />
        </p>
      </div>
      <div class="col-xs-12 col-sm-6">
        <p>
          <strong>Phone:</strong> <%= @submission.author.phone_number %> <br />
          <strong>Alternate email:</strong> <%= @submission.author.alternate_email_address %><br />
        </p>
      </div>
      <div class="col-xs-12">
        <%= link_to edit_admin_author_path(@submission.author), class: 'form-edit-link' do %>
          <span class="fa"></span> Edit Author Information
        <% end %>
      </div>
    </div>
  </div>

  <div class="form-section-heading" data-toggle="collapse" data-target="#program-information">Program Information
    <span class="hide-show-indicator fa-rotate-90"></span>
  </div>
  <div id="program-information" class="form-section-body collapse in">
    <%= f.input :program_id, label: 'Program', collection: Program.all, prompt: "Please Select", input_html: { class: 'can-toggle-selectability' } %>
    <%= f.input :degree_id, label: 'Degree', collection: Degree.all, prompt: "Please Select", input_html: { class: 'can-toggle-selectability' } %>
    <%= f.input :semester, label: 'Semester Intending to Graduate', collection: Submission::SEMESTERS, prompt: "Please Select", input_html: { class: 'can-toggle-selectability' } %>
    <%= f.input :year, label: 'Graduation Year', collection: Submission.years, prompt: "Please Select", input_html: { class: 'can-toggle-selectability' } %>

    <% if @submission.beyond_waiting_for_format_review_response? %>
      <%= link_to '#', class: 'form-edit-link toggle-link' do %>
        <span class="fa"></span> <span class="verb">Edit</span> Program Information
      <% end %>
    <% end %>
  </div>

  <div class="form-section-heading" data-toggle="collapse" data-target="#committee">Committee
    <span class="hide-show-indicator fa-rotate-90"></span>
  </div>
  <div id="committee" class="form-section-body collapse in">
    <%= f.simple_fields_for :committee_members do |cmf| %>
      <fieldset class="committee-member-fields">
        <%= cmf.input :is_advisor, as: :hidden %>
        <%= cmf.input :role, as: :hidden %>
        <div class="row ">
          <div class="col-xs-12">
            <label class="role-label"><%= cmf.object.role %><span title="require" class="required-asterisk">*</span></label>
          </div>
          <div class="col-xs-12 col-sm-6">
            <div class="input-group">
              <span class="input-group-addon">Name</span>
              <%= cmf.input :name, label: false, input_html: { class: 'can-toggle-editability' } %>
            </div>
          </div>
          <div class="col-xs-12 col-sm-6">
            <div class="input-group">
              <span class="input-group-addon">Email</span>
              <%= cmf.input :email, label: false, input_html: { class: 'can-toggle-editability' } %>
            </div>
          </div>
        </div>
      </fieldset>
    <% end %>

    <% if @submission.beyond_waiting_for_format_review_response? %>
      <%= link_to '#', class: 'form-edit-link toggle-link' do %>
        <span class="fa"></span> <span class="verb">Edit</span> Committee
      <% end %>
    <% end %>
  </div>

  <div class="form-section-heading" data-toggle="collapse" data-target="#format-review-files">Format Review Information
    <span class="hide-show-indicator fa-rotate-90"></span>
  </div>
  <div id="format-review-files" class="form-section-body collapse in">
    <div class="links cocoon-links">
      <label>Files<span class="required-astrisk">*</span></label>
      <%= link_to_add_association f, :format_review_files,
          class: 'btn btn-default btn-sm can-toggle-clickability',
          data: { association_insertion_node: '#format-review-file-fields', association_insertion_method: 'append' },
          form_name: 'file_fields',
          partial: 'file_fields' do %>
        <span class="glyphicon glyphicon-plus"></span> Additional File
      <% end %>
    </div>
    <div id="format-review-file-fields">
      <%= f.simple_fields_for :format_review_files do |format_review_file| %>
        <%= render 'file_fields', file_fields: format_review_file %>
      <% end %>
    </div>

    <%= f.input :format_review_notes, as: :text, label: "Format Review Notes to Student<span title='require' class='required-asterisk'>*</span>".html_safe, input_html: { class: 'can-toggle-editability' } %>

    <% if @submission.beyond_waiting_for_format_review_response? %>
      <%= link_to '#', class: 'form-edit-link toggle-link' do %>
        <span class="fa"></span> <span class="verb">Edit</span> Format Review Information
      <% end %>
    <% end %>
  </div>

  <%= render partial: 'final_submission_fields', locals: { f: f } if @submission.beyond_waiting_for_format_review_response? %>

  <div class="form-group actions">
    <%= render partial: "admin/submissions/edit_form_actions/#{@view.actions_partial_name}", locals: { f: f } %>
  </div>

<% end %>
